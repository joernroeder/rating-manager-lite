/**
 * Rating Manager Lite
 *
 * It is based on a script by Prashanth Pamidi.
 * rateYo
 * http://prrashi.github.io/rateyo/
 * Copyright (c) 2014 Prashanth Pamidi; Licensed MIT
 *
 */
!function(t){"use strict";function n(t,n,e){return t===n?t=n:t===e&&(t=e),t}function e(t,n,e){var r=t>=n&&e>=t;if(!r)throw Error("Invalid Rating, expected value between "+n+" and "+e);return t}function r(n,e){var r;return t.each(e,function(){return n===this.node?(r=this,!1):void 0}),r}function i(n,e){return t.each(e,function(t){if(n===this.node){var r=e.slice(0,t),i=e.slice(t+1,e.length);return e=r.concat(i),!1}}),e}function a(t){return"undefined"!=typeof t}function o(r,s){function l(t){a(t)||(t=s.rating);var n=s.minValue,e=s.maxValue,r=(t-n)/(e-n)*100;T.css("width",r+"%")}function u(t){if(!a(t))return s.svgWidth;s.svgWidth=s.starHeight=t;var n=parseInt(s.svgWidth.replace("px","").trim());n*=s.numIcons,r.width(n),A.find("svg").attr({width:s.svgWidth,height:s.starHeight}),T.find("svg").attr({width:s.svgWidth,height:s.starHeight})}function c(t){return a(t)?(s.normalFill=t,void A.find("svg").attr({fill:s.normalFill})):s.normalFill}function d(t){return a(t)?(s.ratedFill=t,void T.find("svg").attr({fill:s.ratedFill})):s.ratedFill}function f(n){if(!a(n))return s.numIcons;s.numIcons=n,A.empty(),T.empty();for(var e=0;e<s.numIcons;e++)A.append(t(j)),T.append(t(j));u(s.svgWidth),d(s.ratedFill),c(s.normalFill),l()}function g(t){return a(t)?(s.minValue=t,l(),t):s.minValue}function h(t){return a(t)?(s.maxValue=t,l(),t):s.maxValue}function p(t){return a(t)?(s.precision=t,void l()):s.precision}function v(t){var n,e=A.offset(),r=e.left,i=r+A.width(),a=s.minValue,o=s.maxValue,l=t.pageX;r>l?n=a:l>i?n=o:(n=(l-r)/(i-r),n*=o-a,n+=a);var u=.5;return n+u}function m(t){var e=v(t).toFixed(s.precision),i=s.minValue,a=s.maxValue;e=n(parseFloat(e),i,a),l(e),r.trigger("ultimateratings.change",{rating:e})}function y(){l(W),r.trigger("ultimateratings.change",{rating:s.rating})}function F(t){var n=v(t).toFixed(s.precision);n=parseFloat(n),O.rating(n)}function V(t,n){s.onChange&&"function"==typeof s.onChange&&s.onChange.apply(this,[n.rating,O])}function x(t,n){s.onSet&&"function"==typeof s.onSet&&s.onSet.apply(this,[n.rating,O])}function b(){r.on("mousemove",m).on("mouseenter",m).on("mouseleave",y).on("click",F).on("ultimateratings.change",V).on("ultimateratings.set",x)}function w(){r.off("mousemove",m).off("mouseenter",m).off("mouseleave",y).off("click",F).off("ultimateratings.change",V).off("ultimateratings.set",x)}function k(t){return a(t)?(s.readOnly=t,w(),void(t||b())):s.readOnly}function C(t){if(!a(t))return s.rating;var i=t,o=s.maxValue,u=s.minValue;"string"==typeof i&&("%"===i[i.length-1]&&(i=i.substr(0,i.length-1),o=h(100),u=g(0)),i=parseFloat(i)),e(i,u,o),i=parseFloat(i.toFixed(s.precision)),n(parseFloat(i),u,o),s.rating=i,l(),r.trigger("ultimateratings.set",{rating:i})}function S(t){return a(t)?void(s.onSet=t):s.onSet}function I(t){return a(t)?void(s.onChange=t):s.onChange}var j=s.svg_source;this.$node=r,this.node=r.get(0);var O=this,W=t(this.node).attr("data-elm-value"),q=t(this.node).attr("data-elm-readonly");"undefined"!=typeof q&&"true"==q&&(s.readOnly=!0),"undefined"!=typeof W&&(s.rating=W),r.addClass("jq-ry-container");var E=t("<div/>").addClass("jq-ry-group-wrapper").appendTo(r),A=t("<div/>").addClass("jq-ry-normal-group").addClass("jq-ry-group").appendTo(E),T=t("<div/>").addClass("jq-ry-rated-group").addClass("jq-ry-group").appendTo(E);this.rating=function(t){return a(t)?(C(t),r):s.rating},this.destroy=function(){return s.readOnly||w(),o.prototype.collection=i(r.get(0),this.collection),r.removeClass("jq-ry-container").children().remove(),r},this.method=function(t){if(!t)throw Error("Method name not specified!");if(!a(this[t]))throw Error("Method "+t+" doesn't exist!");var n=Array.prototype.slice.apply(arguments,[]),e=n.slice(1),r=this[t];return r.apply(this,e)},this.option=function(t,n){if(!a(t))return s;var e;switch(t){case"SVG":e=setSVG;break;case"svgWidth":e=u;break;case"numIcons":e=f;break;case"normalFill":e=c;break;case"ratedFill":e=d;break;case"minValue":e=g;break;case"maxValue":e=h;break;case"precision":e=p;break;case"rating":e=C;break;case"readOnly":e=k;break;case"onSet":e=S;break;case"onChange":e=I;break;default:throw Error("No such option as "+t)}return e(n),s[t]},f(s.numIcons),k(s.readOnly),this.collection.push(this),this.rating(s.rating)}function s(n){var e=o.prototype.collection,i=t(this);if(0===i.length)return i;var a=Array.prototype.slice.apply(arguments,[]);if(0===a.length)n=a[0]={};else{if(1!==a.length||"object"!=typeof a[0]){if(a.length>=1&&"string"==typeof a[0]){var s=a[0],l=a.slice(1),c=[];return t.each(i,function(t,n){var i=r(n,e);if(!i)throw Error("Trying to set options before even initialization");var a=i[s];if(!a)throw Error("Method "+s+" does not exist!");var o=a.apply(i,l);c.push(o)}),c=1===c.length?c[0]:t(c)}throw Error("Invalid Arguments")}n=a[0]}return n=t.extend(JSON.parse(JSON.stringify(u)),n),t.each(i,function(){var i=r(this,e);return i?void 0:new o(t(this),n)})}function l(){return s.apply(this,Array.prototype.slice.apply(arguments,[]))}var u={svgWidth:"24px",normalFill:"#d4d195",ratedFill:"#fdff00",numIcons:5,minValue:0,maxValue:5,precision:0,rating:0,readOnly:!1,onChange:null,onSet:null};o.prototype.collection=[],t.fn.UR=l}(jQuery);